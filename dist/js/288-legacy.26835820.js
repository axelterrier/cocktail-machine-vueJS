(self["webpackChunkcocktail_machine"]=self["webpackChunkcocktail_machine"]||[]).push([[288],{4188:(e,t,n)=>{var i,a,o;(function(l){"use strict";if(null!=t&&"number"!==typeof t.nodeType)e.exports=l();else if(null!=n.amdO)a=[],i=l,o="function"===typeof i?i.apply(t,a):i,void 0===o||(e.exports=o);else{var r=l(),s="undefined"!==typeof self?self:$.global;"function"!==typeof s.btoa&&(s.btoa=r.btoa),"function"!==typeof s.atob&&(s.atob=r.atob)}})((function(){"use strict";var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function t(e){this.message=e}function n(n){for(var i,a,o=String(n),l=0,r=e,s="";o.charAt(0|l)||(r="=",l%1);s+=r.charAt(63&i>>8-l%1*8)){if(a=o.charCodeAt(l+=3/4),a>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");i=i<<8|a}return s}function i(n){var i=String(n).replace(/[=]+$/,"");if(i.length%4===1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,o,l=0,r=0,s="";o=i.charAt(r++);~o&&(a=l%4?64*a+o:o,l++%4)?s+=String.fromCharCode(255&a>>(-2*l&6)):0)o=e.indexOf(o);return s}return t.prototype=new Error,t.prototype.name="InvalidCharacterError",{btoa:n,atob:i}}))},6699:(e,t,n)=>{"use strict";var i=n(2109),a=n(1318).includes,o=n(7293),l=n(1223),r=o((function(){return!Array(1).includes()}));i({target:"Array",proto:!0,forced:r},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),l("includes")},3288:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>g});var i=n(6252),a=n(3577);const o=["src"];function l(e,t,n,l,r,s){const d=(0,i.up)("ion-title"),c=(0,i.up)("ion-searchbar"),u=(0,i.up)("ion-skeleton-text"),p=(0,i.up)("ion-toolbar"),h=(0,i.up)("ion-header"),g=(0,i.up)("ion-card-header"),f=(0,i.up)("ion-card-content"),m=(0,i.up)("ion-card"),b=(0,i.up)("ion-list"),_=(0,i.up)("ion-card-subtitle"),w=(0,i.up)("ion-card-title"),I=(0,i.up)("ion-toggle"),y=(0,i.up)("ion-content"),C=(0,i.up)("ion-page");return(0,i.wg)(),(0,i.j4)(C,null,{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Tab 1 "+(0,a.zw)(e.loading)+" // "+(0,a.zw)(e.activeCount)+" ingrédients sélectionnés",1)])),_:1}),(0,i.Wm)(c,{modelValue:e.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchQuery=t),onInput:t[1]||(t[1]=t=>e.searchQuery=t.target.value)},null,8,["modelValue"]),(0,i.Wm)(u,{animated:!0,style:{width:"80px"}})])),_:1})])),_:1}),(0,i.Wm)(y,{class:"ion-padding"},{default:(0,i.w5)((()=>[e.loading?((0,i.wg)(),(0,i.j4)(b,{key:0},{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.iD)(i.HY,null,(0,i.Ko)(10,(e=>(0,i.Wm)(m,{key:e},{default:(0,i.w5)((()=>[(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[(0,i.Wm)(u,{animated:!0})])),_:1}),(0,i.Wm)(f,null,{default:(0,i.w5)((()=>[(0,i.Wm)(u,{animated:!0,style:{width:"50%"}}),(0,i.Wm)(u,{animated:!0,style:{width:"55%"}}),(0,i.Wm)(u,{animated:!0,style:{width:"45%"}})])),_:1})])),_:2},1024))),64))])),_:1})):((0,i.wg)(),(0,i.j4)(b,{key:1},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.filteredIngredients,(t=>((0,i.wg)(),(0,i.j4)(m,{key:t.ID_Ingredient},{default:(0,i.w5)((()=>[(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[(0,i.Wm)(_,null,{default:(0,i.w5)((()=>[(0,i.Uk)("ID: "+(0,a.zw)(t.ID_Ingredient),1)])),_:2},1024),(0,i.Wm)(w,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.Ingredient_Name),1)])),_:2},1024)])),_:2},1024),(0,i.Wm)(f,null,{default:(0,i.w5)((()=>[(0,i._)("p",null,"Taux d'alcool: "+(0,a.zw)(t.Taux_Alcool),1),(0,i._)("p",null,[(0,i.Uk)("Disponibilité: "+(0,a.zw)(t.Est_Disponible)+" ",1),1===t.Est_Disponible?((0,i.wg)(),(0,i.j4)(I,{key:0,modelValue:t.Est_Disponible,"onUpdate:modelValue":e=>t.Est_Disponible=e,checked:!0,onClick:n=>e.updateAvailability(t)},null,8,["modelValue","onUpdate:modelValue","onClick"])):((0,i.wg)(),(0,i.j4)(I,{key:1,modelValue:t.Est_Disponible,"onUpdate:modelValue":e=>t.Est_Disponible=e,checked:!1,disabled:10===e.activeCount&&0===t.Est_Disponible,onClick:n=>e.updateAvailability(t)},null,8,["modelValue","onUpdate:modelValue","disabled","onClick"]))]),(0,i._)("img",{src:e.toBase64(t.Image_Url)},null,8,o)])),_:2},1024)])),_:2},1024)))),128))])),_:1}))])),_:1})])),_:1})}n(5827),n(2472),n(8675),n(3105),n(3408),n(2958),n(3462),n(3824),n(7658),n(3948),n(6699);var r=n(4188),s=n(2201),d=n(8433),c=n(9162);const u=(0,i.aZ)({components:{IonContent:c.W2,IonHeader:c.Gu,IonToolbar:c.sr,IonTitle:c.wd,IonCard:c.PM,IonCardHeader:c.Zi,IonCardTitle:c.Dq,IonCardSubtitle:c.tO,IonCardContent:c.FN,IonList:c.q_,IonSkeletonText:c.CK,IonPage:c._i},data(){return{ingredients:[],loading:!0,searchQuery:"",activeCount:0,availableIngredients:[]}},setup(){const e=(0,s.tv)();return{router:e}},async created(){try{const e=await d.Z.get("http://localhost:8888/api/V1/ingredients");this.ingredients=e.data,this.loading=!1,this.activeCount=this.ingredients.reduce(((e,t)=>e+(t.Est_Disponible?1:0)),0),this.availableIngredients=this.ingredients.filter((e=>e.Est_Disponible)).map((e=>e.ID_Ingredient))}catch(e){console.error(e)}},methods:{toBase64(e){return"data:image/jpeg;base64,"+(0,r.btoa)(new Uint8Array(e.data).reduce(((e,t)=>e+String.fromCharCode(t)),""))},async updateAvailability(e){if(e.Est_Disponible=1===e.Est_Disponible?0:1,this.activeCount+=1===e.Est_Disponible?1:-1,1===e.Est_Disponible)this.availableIngredients.push(e.ID_Ingredient);else{const t=this.availableIngredients.indexOf(e.ID_Ingredient);t>-1&&this.availableIngredients.splice(t,1)}console.log("Ingr Dispo"+this.availableIngredients),await this.saveChanges(e),await this.updateCocktails()},async saveChanges(e){try{await d.Z.put(`http://localhost:8888/api/V1/ingredients/${e.ID_Ingredient}`,{Est_Disponible:e.Est_Disponible})}catch(t){console.error("error :"+t)}},async updateCocktails(){try{const t=await d.Z.get("http://localhost:8888/api/V1/cocktailcomposition");this.cocktailcomposition=t.data;const n=t.data.reduce(((e,t)=>{const{ID_Cocktail:n,Ingredient_ID:i,Quantite:a}=t;return e[n]||(e[n]=[]),e[n].push({Ingredient_ID:i,Quantite:a}),e}),{}),i=Object.keys(n).map((e=>({ID_Cocktail:e,ingredients:n[e]})));for(const a of i){let t=!0;for(const e of a.ingredients)if(!this.availableIngredients.includes(e.Ingredient_ID)){t=!1;break}if(t){console.log(a);try{await d.Z.put(`http://localhost:8888/api/V1/cocktail/${a.ID_Cocktail}`,{Est_Disponible:1})}catch(e){console.error("error :"+e)}}else try{await d.Z.put(`http://localhost:8888/api/V1/cocktail/${a.ID_Cocktail}`,{Est_Disponible:0})}catch(e){console.error("error :"+e)}}if(this.activeCount>=10){const e=await c.Cl.create({header:"Oh doucement malheureux",message:"Le nombre maximal d'ingrédients sélectionnés est atteint !",buttons:["OK"]});return void await e.present()}}catch(e){console.error(e)}}},computed:{filteredIngredients(){return this.ingredients.filter((e=>e.Ingredient_Name.toLowerCase().indexOf(this.searchQuery.toLowerCase())>-1))}}});var p=n(3744);const h=(0,p.Z)(u,[["render",l]]),g=h}}]);
//# sourceMappingURL=288-legacy.26835820.js.map